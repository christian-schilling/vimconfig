#!/bin/python

import commands

root = commands.getoutput("git rev-parse --show-toplevel")

diff = commands.getoutput("git diff -U0").split("\n")

for line in diff:
    if line.startswith("+++"):
        filename = root+line[5:]
    if line.startswith("@@"):
        rem,add = line.split("@@")[1].strip().split(" ")
        rem = rem[1:]
        if "," not in rem:
            rem = 1
        else:
            rem = rem.split(",")[1]

        add = add[1:]
        if "," not in add:
            add = 1
        else:
            add = add.split(",")[1]

        linenumber = line.split("+")[1].split(" ")[0].split(",")[0]
        outline = "{}:{}: {} deleted {} added".format(
            filename,linenumber,rem,add
        )
        print outline
    if line.startswith("-") and not line.startswith("---"):
        print line[1:]

